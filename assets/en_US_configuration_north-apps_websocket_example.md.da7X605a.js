import{_ as t,c as i,o as a,ah as s,cL as n,cM as r,cN as o,cO as d,cP as h,cQ as l,cR as c,cS as p,cT as g,cU as b,cV as k,cW as u,cX as f,cY as m,cZ as y,c_ as w}from"./chunks/framework.D2dsaVOY.js";const A=JSON.parse('{"title":"WebSocket Plugin Data Upload Walkthrough","description":"","frontmatter":{},"headers":[],"relativePath":"en_US/configuration/north-apps/websocket/example.md","filePath":"en_US/configuration/north-apps/websocket/example.md"}'),F={name:"en_US/configuration/north-apps/websocket/example.md"};function E(C,e,D,v,B,_){return a(),i("div",null,[...e[0]||(e[0]=[s(`<h1 id="websocket-plugin-data-upload-walkthrough" tabindex="-1">WebSocket Plugin Data Upload Walkthrough <a class="header-anchor" href="#websocket-plugin-data-upload-walkthrough" aria-label="Permalink to “WebSocket Plugin Data Upload Walkthrough”">​</a></h1><p>In this tutorial, we show how to upload data collected from south devices to a WebSocket server using the GridBeat WebSocket plugin.</p><h2 id="tutorial-setup" tabindex="-1">Tutorial Setup <a class="header-anchor" href="#tutorial-setup" aria-label="Permalink to “Tutorial Setup”">​</a></h2><p>We use two PCs connected to a local area network in this tutorial.</p><ul><li>One is a Linux machine with GridBeat installed</li><li>One is a Linux machine with a WebSocket server. Consult the <a href="./../../../installation/installation.html">the installation instruction</a> on how to install GridBeat.</li></ul><table tabindex="0"><thead><tr><th></th><th>PC 1</th><th>PC 2</th></tr></thead><tbody><tr><td>Operating System</td><td>Linux</td><td>Linux</td></tr><tr><td>IP address</td><td>192.168.1.152</td><td>192.168.1.107</td></tr><tr><td>Software</td><td>GridBeat</td><td>Python 3.7</td></tr><tr><td>Network</td><td>Connected</td><td>Connected</td></tr></tbody></table><p>For this demonstration, you&#39;ll need a WebSocket server that communicates using the WebSocket protocol. You have the flexibility to choose any server software that supports WebSocket. To keep things straightforward, we&#39;ll use a simple Python program in this tutorial. The Python server program requires Python version 3.7 or higher and relies on the <a href="https://websockets.readthedocs.io/en/stable/" target="_blank" rel="noreferrer">websockets package</a> for implementation.</p><p>Run the following command to install the dependencies.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> websockets</span></span></code></pre></div><h2 id="configure-websocket-server" tabindex="-1">Configure WebSocket Server <a class="header-anchor" href="#configure-websocket-server" aria-label="Permalink to “Configure WebSocket Server”">​</a></h2><p>Following is our python server program, it listens at TCP port <em>8000</em>.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/usr/bin/env python</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asyncio</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> websockets</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(websocket):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> websocket:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(message)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> websockets.serve(echo, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.0.0.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asyncio.Future()  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># run forever</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">asyncio.run(main())</span></span></code></pre></div><p>Start the server program:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> websockets.py</span></span></code></pre></div><h2 id="configure-gridbeat" tabindex="-1">Configure GridBeat <a class="header-anchor" href="#configure-gridbeat" aria-label="Permalink to “Configure GridBeat”">​</a></h2><h3 id="south-devices" tabindex="-1">South devices <a class="header-anchor" href="#south-devices" aria-label="Permalink to “South devices”">​</a></h3><p>We need some south devices to collect data from. Any GridBeat southbound plugin will do for this tutorial, for example, the <a href="./../../south-devices/modbus-tcp/modbus-tcp.html">Modbus TCP plugin</a>. In this tutorial, we will use the <a href="./../../south-devices/file/file.html">File plugin</a> to create south devices collecting data from local files. This makes things simple since we don&#39;t need an actual device and we can fake tag data by just modifying file contents.</p><h4 id="add-the-file-node" tabindex="-1">Add the <em>file</em> Node <a class="header-anchor" href="#add-the-file-node" aria-label="Permalink to “Add the file Node”">​</a></h4><p>In the GridBeat dashboard, click <strong>Configuration -&gt; South Devices -&gt; Add Device</strong> to add a node using the File plugin.</p><figure align="center"><img src="`+n+'" style="border:thin solid #E0DCD9;width:60%;" alt="Add file node in GridBeat dashboard"><figcaption align="center"><sub><b>Fig.1 - Add *file* node in GridBeat dashboard</b></sub></figcaption></figure><p>Click the <strong>Device configuration</strong> icon to configure the <em>file</em> node.</p><figure align="center"><img src="'+r+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard sourth devices tab"><figcaption align="center"><sub><b>Fig.2 - GridBeat dashboard sourth devices tab</b></sub></figcaption></figure><p>Click <strong>Submit</strong> to keep the default settings.</p><figure align="center"><img src="'+o+'" style="border:thin solid #E0DCD9;width:60%;" alt="Configure the file node in the GridBeat dashboard"><figcaption align="center"><sub><b>Fig.3 - Configure the *file* node in the GridBeat dashboard</b></sub></figcaption></figure><h4 id="create-a-group" tabindex="-1">Create a Group <a class="header-anchor" href="#create-a-group" aria-label="Permalink to “Create a Group”">​</a></h4><p>The <em>file</em> node should be in <strong>Connected</strong> state once configured. Click the <em>file</em> node to enter the <strong>Group List</strong> tab, then click <strong>Create</strong> to create a group.</p><figure align="center"><img src="'+d+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard sourth devices tab showing file node connected"><figcaption align="center"><sub><b>Fig.4 - GridBeat dashboard sourth devices tab showing *file* node connected</b></sub></figcaption></figure><p>We set the group name to <em>grp</em> and the interval to <em>1000</em>.</p><figure align="center"><img src="'+h+'" style="border:thin solid #E0DCD9;width:60%;" alt="Add a group to the file node in GridBeat dashboard"><figcaption align="center"><sub><b>Fig.5 - Add a group to the *file* node in GridBeat dashboard</b></sub></figcaption></figure><h4 id="add-tag" tabindex="-1">Add Tag <a class="header-anchor" href="#add-tag" aria-label="Permalink to “Add Tag”">​</a></h4><p>Click the created <em>grp</em> group to enter the <strong>Tag List</strong> tab, then click <strong>Create</strong> to create a tag.</p><figure align="center"><img src="'+l+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard group list"><figcaption align="center"><sub><b>Fig.6 - GridBeat dashboard group list</b></sub></figcaption></figure><p>We name the tag <em>tag0</em> with type <em>STRING</em>. The tag address is set to <em>hello.txt</em> which represents the file in the working directory of the GridBeat process.</p><figure align="center"><img src="'+c+'" style="border:thin solid #E0DCD9;width:60%;" alt="Add a tag to the file node in GridBeat dashboard"><figcaption align="center"><sub><b>Fig.7 - Add a tag to the *file* node in GridBeat dashboard</b></sub></figcaption></figure><h3 id="north-app" tabindex="-1">North app <a class="header-anchor" href="#north-app" aria-label="Permalink to “North app”">​</a></h3><h4 id="add-the-websocket-node" tabindex="-1">Add the <em>WebSocket</em> Node <a class="header-anchor" href="#add-the-websocket-node" aria-label="Permalink to “Add the WebSocket Node”">​</a></h4><p>In the GridBeat dashboard, click <strong>Configuration -&gt; North Apps -&gt; Add Application</strong> to add a node using the WebSocket plugin.</p><figure align="center"><img src="'+p+'" style="border:thin solid #E0DCD9;width:60%;" alt="Add websocket node in GridBeat dashboard"><figcaption align="center"><sub><b>Fig.8 - Add *websocket* node in GridBeat dashboard</b></sub></figcaption></figure><p>Click the <strong>Application Configuration</strong> icon to configure the <em>WebSocket</em> node.</p><figure align="center"><img src="'+g+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard north apps tab"><figcaption align="center"><sub><b>Fig.9 - GridBeat dashboard north apps tab</b></sub></figcaption></figure><p>We set the <strong>host</strong> parameter to <em>192.168.1.107</em> and <strong>port</strong> to <em>8000</em>, which is the address of our WebSocket server.</p><figure align="center"><img src="'+b+'" style="border:thin solid #E0DCD9;width:60%;" alt="Configure websocket node in GridBeat dashboard"><figcaption align="center"><sub><b>Fig.10 - Configure *websocket* node in GridBeat dashboard</b></sub></figcaption></figure><p>Once the configuration is submitted, the <em>WebSocket</em> node connects to the WebSocket server successfully.</p><figure align="center"><img src="'+k+'" style="border:thin solid #E0DCD9;width:60%;" alt="websocket node connected state in GridBeat dashboard"><figcaption align="center"><sub><b>Fig.11 - GridBeat dashboard north apps tab showing *websocket* node connected</b></sub></figcaption></figure><h4 id="subscribe-to-the-file-node" tabindex="-1">Subscribe to the <em>File</em> Node <a class="header-anchor" href="#subscribe-to-the-file-node" aria-label="Permalink to “Subscribe to the File Node”">​</a></h4><p>Click the <em>WebSocket</em> node to enter the <strong>Subscription</strong> tab. Then click <strong>Add subscription</strong>, select the <em>file</em> node and the <em>grp</em> group.</p><figure align="center"><img src="'+u+'" style="border:thin solid #E0DCD9;width:60%;" alt="websocket node subscribe to file node"><figcaption align="center"><sub><b>Fig.12 - *websocket* node subscribe to *file* node</b></sub></figcaption></figure><h2 id="monitor-data" tabindex="-1">Monitor Data <a class="header-anchor" href="#monitor-data" aria-label="Permalink to “Monitor Data”">​</a></h2><p>After subscribing to the <em>grp</em> group of the <em>file</em> node, the <em>WebSocket</em> node will begin pushing data to the WebSocket server. In the GridBeat dashboard, click <strong>Monitoring -&gt; Data monitoring</strong>, then select the <em>file</em> node and the <em>grp</em> group. We see that GridBeat reports an error code <em>1011</em> indicating the file <em>hello.txt</em> does not exist.</p><figure align="center"><img src="'+f+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard data monitoring tab"><figcaption align="center"><sub><b>Fig.13 - GridBeat dashboard data monitoring tab showing error</b></sub></figcaption></figure><p>We can check the server output that it receives the data correctly. And sure, the received data says that <em>tag0</em> encounters the error code <em>1011</em>.</p><figure align="center"><img src="'+m+'" style="border:thin solid #E0DCD9;width:60%;" alt="WebSocket server output"><figcaption align="center"><sub><b>Fig.14 - WebSocket server output showing error code 1011</b></sub></figcaption></figure><p>In the GridBeat process working directory, create the <em>hello.txt</em> file with the content <em>world</em>.</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> world</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hello.tx</span></span></code></pre></div><p>Now we can see that GridBeat updates <em>tag0</em> correctly in the <strong>Data monitoring</strong> tab.</p><figure align="center"><img src="'+y+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard data monitoring tab"><figcaption align="center"><sub><b>Fig.15 - GridBeat dashboard data monitoring tab showing updated value</b></sub></figcaption></figure><p>And the WebSocket server receives the correct tag data, <em>world</em>, which is expected.</p><figure align="center"><img src="'+w+'" style="border:thin solid #E0DCD9;width:60%;" alt="WebSocket server output"><figcaption align="center"><sub><b>Fig.16 - WebSocket server output showing correct value</b></sub></figcaption></figure>',58)])])}const G=t(F,[["render",E]]);export{A as __pageData,G as default};
