import{_ as s,c as i,o as a,ah as t}from"./chunks/framework.D2dsaVOY.js";const k=JSON.parse('{"title":"Development Guide","description":"","frontmatter":{},"headers":[],"relativePath":"en_US/dev-guide/dev-guide.md","filePath":"en_US/dev-guide/dev-guide.md"}'),n={name:"en_US/dev-guide/dev-guide.md"};function l(r,e,o,h,d,p){return a(),i("div",null,[...e[0]||(e[0]=[t(`<h1 id="development-guide" tabindex="-1">Development Guide <a class="header-anchor" href="#development-guide" aria-label="Permalink to “Development Guide”">​</a></h1><h2 id="code-structure" tabindex="-1">Code Structure <a class="header-anchor" href="#code-structure" aria-label="Permalink to “Code Structure”">​</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>gridbeat</span></span>
<span class="line"><span>├── cmake</span></span>
<span class="line"><span>├── deploy</span></span>
<span class="line"><span>├── ft</span></span>
<span class="line"><span>├── include</span></span>
<span class="line"><span>├── persistence</span></span>
<span class="line"><span>├── plugins</span></span>
<span class="line"><span>├── simulator</span></span>
<span class="line"><span>├── src</span></span>
<span class="line"><span>└── tests</span></span></code></pre></div><p><code>cmake</code> stores cross compiled files, <code>ft</code> stores functional test files, <code>include</code> stores external header files, <code>plugins</code> stores southbound plug-ins, <code>simulator</code> stores modbus simulator related files, and <code>tests</code> stores unit test files.</p><h2 id="coding-guide" tabindex="-1">Coding Guide <a class="header-anchor" href="#coding-guide" aria-label="Permalink to “Coding Guide”">​</a></h2><p>GridBeat code follows the principle of high readability and has the following specification requirements:</p><ul><li>Macros are all uppercase, except for macros, which are all lowercase.</li><li>Variables, functions, structures, and other names are meaningful English words separated by underscores.</li><li>Maintain a good naming style, and be able to make naming a comment without adding invalid comments.</li><li>Each C file should be the smallest set of strongly related functions.</li><li>Only functions and variables that need to be exported externally are added to the header file.</li><li>GridBeat uses clang format for code formatting, and the clang format file is located in the GridBeat root directory.</li><li>Functions should be as short as possible. Each function only implements one function. The logic of the function is clear (it can be easily understood by looking at previously written code after a period of time), and the maximum length of the function should not exceed 80 lines.</li></ul><h2 id="branch" tabindex="-1">Branch <a class="header-anchor" href="#branch" aria-label="Permalink to “Branch”">​</a></h2><p>This project has a main branch, <code>main</code>. Please ensure that <code>main</code> is compiled and usable at any time. At the same time, there are branches corresponding to different versions of this project, and you can choose your own branches for development.</p><h2 id="modify-code" tabindex="-1">Modify Code <a class="header-anchor" href="#modify-code" aria-label="Permalink to “Modify Code”">​</a></h2><p>For functional issues, please submit at least one test case to verify changes to existing functionality; For performance related issues, please submit necessary test data to prove the performance defects of existing code or the performance improvement of new code. Please perform tests before each push.</p><h3 id="unit-testing" tabindex="-1">Unit testing <a class="header-anchor" href="#unit-testing" aria-label="Permalink to “Unit testing”">​</a></h3><p>Run all unit tests</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ctest</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --output-on-failure</span></span></code></pre></div><h3 id="functional-testing" tabindex="-1">Functional testing <a class="header-anchor" href="#functional-testing" aria-label="Permalink to “Functional testing”">​</a></h3><p>Run all functional tests</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mosquitto</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mosquitto</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">python3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pip</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">python3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ft/requirements.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">python3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> robot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --maxerroelines=600</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ft/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ft/reports</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ft</span></span></code></pre></div><h2 id="pull-request" tabindex="-1">Pull Request <a class="header-anchor" href="#pull-request" aria-label="Permalink to “Pull Request”">​</a></h2><ul><li><p>A PR only does one thing. If there are multiple bug fixes, please submit a PR for each bug;</p></li><li><p>The PR process is as follows:</p><ul><li>First, fork this project and create your own github.com/your/gridbeat warehouse;</li><li>Clone your own GridBeat warehouse to the local location:</li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/your/gridbeat.git</span></span></code></pre></div><ul><li>For example, create a new branch based on the <code>main</code> branch;</li><li>Make changes on the newly created branch and submit the changes;</li><li>Before pushing the modified branch to your own warehouse, switch to the <code>main</code> branch and run the following command to pull the latest remote code:</li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/emqx/gridbeat.git</span></span></code></pre></div><ul><li>If the new remote code is retrieved in the previous step, switch to the previously created branch and run branch merge operation.</li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rebase</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main</span></span></code></pre></div><p>If you encounter a file conflict, you need to resolve the conflict;</p><ul><li>After the previous step is completed, you can push the branch you created to your own warehouse:</li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;user-select:none;-webkit-user-select:none;">$ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main</span></span></code></pre></div><ul><li>Finally, send a PR to the corresponding branch of emqx/gridbeat from the newly pushed branch of your warehouse;</li></ul></li><li><p>Provide a complete description of the problems solved/new features added/the intent of the modifications made to the code in the title and text of the PR;</p></li><li><p>Wait patiently for the developer&#39;s response, and we will respond soon.</p></li></ul><h2 id="debugging" tabindex="-1">Debugging <a class="header-anchor" href="#debugging" aria-label="Permalink to “Debugging”">​</a></h2><ol><li>Use logs to print relevant debugging information.</li><li>Because GridBeat is a multithreaded asynchronous concurrent program, it is not recommended to use GDB for breakpoint debugging, etc.</li><li>Combining libasan runtime memory analysis, most memory issues can be resolved.</li></ol><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>Libasan refers to the Address Sanitizer (ASan) library, which is a memory error detection tool used to help detect memory errors during program execution, such as buffer overflows, using freed memory, and using uninitialized memory.<br> ASan detects memory errors by injecting additional code while the program is running. It uses a red and black tree data structure to track the allocation of memory blocks, and uses shadow memory to detect read and write access to unallocated memory. When a memory error is detected, ASan prints relevant information, such as the location and type of the error.<br> Libasan is a runtime library for ASan that can be used with compilers, such as Clang, GCC, and so on. It provides the necessary functions and data structures to detect and report memory errors during program execution.</p></div>`,22)])])}const u=s(n,[["render",l]]);export{k as __pageData,u as default};
