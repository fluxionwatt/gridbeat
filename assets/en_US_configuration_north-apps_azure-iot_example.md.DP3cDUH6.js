import{_ as t,c as r,o as a,ah as o,bx as i,by as s,bz as n,bA as d,bB as c,bC as u,bD as h,bE as l,bF as g,bG as b,bH as m,bI as p,bJ as f,bK as z,bL as T,bM as v,bN as A,bO as I,bP as _}from"./chunks/framework.D2dsaVOY.js";const S=JSON.parse('{"title":"Bridging Data to Microsoft Azure IoT Hub using GridBeat","description":"","frontmatter":{},"headers":[],"relativePath":"en_US/configuration/north-apps/azure-iot/example.md","filePath":"en_US/configuration/north-apps/azure-iot/example.md"}'),w={name:"en_US/configuration/north-apps/azure-iot/example.md"};function y(D,e,k,x,H,C){return a(),r("div",null,[...e[0]||(e[0]=[o('<h1 id="bridging-data-to-microsoft-azure-iot-hub-using-gridbeat" tabindex="-1">Bridging Data to Microsoft Azure IoT Hub using GridBeat <a class="header-anchor" href="#bridging-data-to-microsoft-azure-iot-hub-using-gridbeat" aria-label="Permalink to “Bridging Data to Microsoft Azure IoT Hub using GridBeat”">​</a></h1><p>This article will introduce how to use GridBeat to bridge data to Microsoft Azure IoT Hub through the public network so that you can easily build IoT applications.</p><h2 id="what-is-microsoft-azure-iot-hub" tabindex="-1">What is Microsoft Azure IoT Hub? <a class="header-anchor" href="#what-is-microsoft-azure-iot-hub" aria-label="Permalink to “What is Microsoft Azure IoT Hub?”">​</a></h2><p>The internet of things (IoT) enables everyday physical objects to connect to the internet and intercommunicate, changing the way we live and work. Azure IoT Hub, a cloud service provided by Microsoft, is a fully managed service that enables organizations to manage, monitor, and control IoT devices.</p><p>In addition, Azure IoT Hub enables reliable, secure bidirectional communications between IoT devices and its cloud-based services. It allows developers to receive messages from, and send messages to, IoT devices, acting as a central message hub for communication. It can also help organizations make use of data obtained from IoT devices, transforming IoT data into actionable insights.</p><h2 id="getting-started-with-azure-iot-hub" tabindex="-1">Getting started with Azure IoT Hub <a class="header-anchor" href="#getting-started-with-azure-iot-hub" aria-label="Permalink to “Getting started with Azure IoT Hub”">​</a></h2><p>Here are the general steps for starting to use Azure IoT Hub.</p><h3 id="setting-up-azure-iot-hub" tabindex="-1">Setting up Azure IoT Hub <a class="header-anchor" href="#setting-up-azure-iot-hub" aria-label="Permalink to “Setting up Azure IoT Hub”">​</a></h3><p>The initial setup process is straightforward. You will need an active Azure subscription. If you do not have one, create a free account.</p><p>Once you have an active subscription, log in to the <a href="https://portal.azure.com/" target="_blank" rel="noreferrer">Azure portal</a>. Navigate to the IoT Hub section and click on the <strong>Create</strong> button. You will need to provide details like the subscription, resource group, region, and name of the IoT Hub. Once these details are filled in, click on the <strong>Review + Create</strong> button to create your IoT Hub.</p><p>Here we create an IoT Hub called <em>emqx-hub</em>, and its hostname is <em>emqx-hub.azure-devices.net</em>.</p><figure align="center"><img src="'+i+'" style="border:thin solid #E0DCD9;width:60%;" alt="set up Azure IoT Hub"></figure><h3 id="registering-devices-to-azure-iot-hub" tabindex="-1">Registering devices to Azure IoT Hub <a class="header-anchor" href="#registering-devices-to-azure-iot-hub" aria-label="Permalink to “Registering devices to Azure IoT Hub”">​</a></h3><p>Once your Azure IoT Hub is set up, the next step is to register your devices to the Hub.</p><p>To register a device, navigate to the IoT devices section in your IoT Hub and click on the <strong>Add</strong> button. Provide a unique name for the device and click on <strong>Save</strong>.</p><p>Here, we registered a device <em>client-005</em> for GridBeat.</p><figure align="center"><img src="'+s+'" style="border:thin solid #E0DCD9;width:60%;" alt="Azure IoT Hub add device"></figure><h3 id="use-azure-iot-explorer" tabindex="-1">Use Azure IoT Explorer <a class="header-anchor" href="#use-azure-iot-explorer" aria-label="Permalink to “Use Azure IoT Explorer”">​</a></h3><p>Once your devices are connected to Azure IoT Hub, they can start sending messages to the Hub. These messages can be telemetry data, like sensor readings, or any other data that you want to send from your devices to the cloud. In the reverse direction, messages could be sent from the Hub to the devices.</p><p>We will use <a href="https://learn.microsoft.com/en-us/azure/iot/howto-use-iot-explorer" target="_blank" rel="noreferrer">Azure IoT Explorer</a> to monitor messages between Azure IoT Hub and GridBeat.</p><p>The first time you run Azure IoT explorer, you&#39;re prompted for your IoT hub&#39;s connection string. Find the <em>emqx-hub</em> IoT Hub connection string in <a href="https://portal.azure.com/" target="_blank" rel="noreferrer">Azure portal</a>.</p><figure align="center"><img src="'+n+'" style="border:thin solid #E0DCD9;width:60%;" alt="Azure IoT Hub connection string"></figure><p>After you add the connection string in Azure IoT Explorer, select <strong>Connect</strong>.</p><figure align="center"><img src="'+d+'" style="border:thin solid #E0DCD9;width:60%;" alt="Azure IoT Explorer connect"></figure><h3 id="device-authentication" tabindex="-1">Device authentication <a class="header-anchor" href="#device-authentication" aria-label="Permalink to “Device authentication”">​</a></h3><p>IoT Hub uses <a href="https://learn.microsoft.com/en-us/azure/iot-hub/authenticate-authorize-sas?tabs=node" target="_blank" rel="noreferrer">shared access signature</a> (SAS) tokens to authenticate devices and services to avoid sending keys on the wire. You use SAS tokens to grant time-bounded access to devices and services to specific functionality in IoT Hub. To get authorization to connect to IoT Hub, devices and services must send SAS tokens signed with either a shared access or symmetric key.</p><p>Alternatively, Azure IoT Hub can authenticate devices using X.509 certificates. For that to work, you should <a href="https://learn.microsoft.com/en-us/azure/iot-hub/tutorial-x509-test-certs?tabs=linux" target="_blank" rel="noreferrer">create and upload certificates</a> first.</p><p>Azure IoT Explorer could help generate SAS tokens for convenience.</p><figure align="center"><img src="'+c+'" style="border:thin solid #E0DCD9;width:60%;" alt="Azure IoT Explorer SAS token"></figure><h2 id="configure-gridbeat" tabindex="-1">Configure GridBeat <a class="header-anchor" href="#configure-gridbeat" aria-label="Permalink to “Configure GridBeat”">​</a></h2><h3 id="south-device" tabindex="-1">South device <a class="header-anchor" href="#south-device" aria-label="Permalink to “South device”">​</a></h3><p>We need some south devices to collect data from. Any GridBeat southbound plugin will do for this tutorial, for example, the <a href="./../../south-devices/modbus-tcp/modbus-tcp.html">Modbus TCP plugin</a>.</p><h4 id="add-the-modbus-tcp-node" tabindex="-1">Add the <em>modbus-tcp</em> Node <a class="header-anchor" href="#add-the-modbus-tcp-node" aria-label="Permalink to “Add the modbus-tcp Node”">​</a></h4><p>Click <strong>South Devices -&gt; Add Device</strong> to add a node using the Modbus TCP plugin. This tutorial will connect to a modbus simulator at port <code>60502</code>.</p><figure align="center"><img src="'+u+'" style="border:thin solid #E0DCD9;width:60%;" alt="Add modbus node in GridBeat dashboard"></figure><h4 id="create-a-group" tabindex="-1">Create a Group <a class="header-anchor" href="#create-a-group" aria-label="Permalink to “Create a Group”">​</a></h4><p>Click the <em>modbus-tcp</em> node to create a group. We set the group name to <em>group</em> and the interval to <em>1000</em>.</p><figure align="center"><img src="'+h+'" style="border:thin solid #E0DCD9;width:60%;" alt="Add a group to the modbus node in GridBeat dashboard"></figure><h4 id="add-tag" tabindex="-1">Add tag <a class="header-anchor" href="#add-tag" aria-label="Permalink to “Add tag”">​</a></h4><p>Click the created <em>group</em> group to create a tag with the name <em>tag0</em> and with type <em>INT16</em>.</p><figure align="center"><img src="'+l+'" style="border:thin solid #E0DCD9;width:60%;" alt="Add a tag to the modbus node in GridBeat dashboard"></figure><p>Finally, check that the <em>modbus-tcp</em> node is in <strong>Connected</strong> state.</p><figure align="center"><img src="'+g+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard sourth devices tab showing modbus node connected"></figure><h3 id="north-app" tabindex="-1">North app <a class="header-anchor" href="#north-app" aria-label="Permalink to “North app”">​</a></h3><h4 id="add-the-azure-node" tabindex="-1">Add the <em>azure</em> Node <a class="header-anchor" href="#add-the-azure-node" aria-label="Permalink to “Add the azure Node”">​</a></h4><p>Click <strong>North Apps -&gt; Add Application</strong> to add a node using the Azure IoT plugin.</p><figure align="center"><img src="'+b+'" style="border:thin solid #E0DCD9;width:60%;" alt="Add azure node in GridBeat dashboard"></figure><p>In the <strong>Application Configuration</strong> tab, configure the <em>azure</em> node. In order to make MQTT connections to Azure IoT Hub, the GridBeat Azure IoT plugin must be provided with either a <strong>Shared Access Signature</strong> or <strong>X.509 Certificates</strong> for authentication. Here, we provides a <strong>SAS Token</strong>.</p><figure align="center"><img src="'+m+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard north apps tab"></figure><p>Once the configuration is submitted, the <em>azure</em> node connects to Azure IoT Hub successfully.</p><figure align="center"><img src="'+p+'" style="border:thin solid #E0DCD9;width:60%;" alt="azure node connected state in GridBeat dashboard"></figure><h4 id="subscribe-to-the-modbus-tcp-node" tabindex="-1">Subscribe to the <em>modbus-tcp</em> Node <a class="header-anchor" href="#subscribe-to-the-modbus-tcp-node" aria-label="Permalink to “Subscribe to the modbus-tcp Node”">​</a></h4><p>Click the <em>azure</em> node, then click <strong>Add subscription</strong>, select the <em>modbus-tcp</em> node and the <em>group</em> group.</p><p>After a device connects, it can send messages to Azure IoT Hub using the MQTT topic <code>devices/{device-id}/messages/events/</code>, where <code>{device-id}</code> is the <strong>Device ID</strong> of the registered device. In our case, the <em>azure</em> node will publish south device data to the topic <code>devices/client-005/messages/events/</code>.</p><figure align="center"><img src="'+f+'" style="border:thin solid #E0DCD9;width:60%;" alt="azure node subscribe to modbus node"></figure><figure align="center"><img src="'+z+'" style="border:thin solid #E0DCD9;width:60%;" alt="azure node subscribe list"></figure><h2 id="monitor-data" tabindex="-1">Monitor Data <a class="header-anchor" href="#monitor-data" aria-label="Permalink to “Monitor Data”">​</a></h2><p>After subscribing to the <em>group</em> group of the <em>modbus-tcp</em> node, the <em>azure</em> node will begin pushing data to the Azure IoT Hub. Click <strong>Monitoring</strong>, then select the <em>modbus-tcp</em> node and the <em>group</em> group. We see that GridBeat reports a initial value <em>0</em> for <em>tag0</em>.</p><figure align="center"><img src="'+T+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard data monitoring tab"></figure><p>In Azure IoT Explorer, click <strong>Telemetry -&gt; Start</strong> to view the device to cloud messages. We can check that Azure IoT Hub receives the data correctly.</p><figure align="center"><img src="'+v+'" style="border:thin solid #E0DCD9;width:60%;" alt="Azure IoT Explorer telemetry 1"></figure><h2 id="write-data" tabindex="-1">Write Data <a class="header-anchor" href="#write-data" aria-label="Permalink to “Write Data”">​</a></h2><p>In Azure IoT Explorer, click <strong>Cloud-to-device message</strong> to send a write request to GridBeat, which writes value <em>42</em> to the tag <em>tag0</em>.</p><figure align="center"><img src="'+A+'" style="border:thin solid #E0DCD9;width:60%;" alt="Azure IoT Explorer write"></figure><p>Now we can see that GridBeat updates <em>tag0</em> correctly in the <strong>Data monitoring</strong> tab.</p><figure align="center"><img src="'+I+'" style="border:thin solid #E0DCD9;width:60%;" alt="GridBeat dashboard data monitoring tab"></figure><p>And Azure IoT Hub receives the correct tag data, <em>42</em>, which is expected.</p><figure align="center"><img src="'+_+'" style="border:thin solid #E0DCD9;width:60%;" alt="Azure IoT Explorer telemetry 2"></figure>',68)])])}const B=t(w,[["render",y]]);export{S as __pageData,B as default};
