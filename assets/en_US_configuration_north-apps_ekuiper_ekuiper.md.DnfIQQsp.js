import{_ as e,c as a,o as s,ah as t,bQ as n,bR as r,bS as o,bT as p,bU as l,bV as h,bW as c,bX as d,bY as k,bZ as u,b_ as g,b$ as m}from"./chunks/framework.D2dsaVOY.js";const A=JSON.parse('{"title":"GridBeat and eKuiper Integration Best Practices","description":"","frontmatter":{},"headers":[],"relativePath":"en_US/configuration/north-apps/ekuiper/ekuiper.md","filePath":"en_US/configuration/north-apps/ekuiper/ekuiper.md"}'),E={name:"en_US/configuration/north-apps/ekuiper/ekuiper.md"};function f(y,i,b,_,F,C){return s(),a("div",null,[...i[0]||(i[0]=[t(`<h1 id="gridbeat-and-ekuiper-integration-best-practices" tabindex="-1">GridBeat and eKuiper Integration Best Practices <a class="header-anchor" href="#gridbeat-and-ekuiper-integration-best-practices" aria-label="Permalink to “GridBeat and eKuiper Integration Best Practices”">​</a></h1><p>This article provides a detailed introduction to deploying GridBeat 2.4 and eKuiper 1.9 with TCP connection using Docker Compose. Here is the specific configuration process:</p><h2 id="quick-deployment" tabindex="-1">Quick Deployment <a class="header-anchor" href="#quick-deployment" aria-label="Permalink to “Quick Deployment”">​</a></h2><p>Both GridBeat and eKuiper support binary installation packages and Docker container deployment solutions. This article takes the Docker solution as an example and uses the <a href="https://docs.docker.com/compose/" target="_blank" rel="noreferrer">Docker Compose</a> approach to achieve one-click deployment of the two components on the edge.</p><ol><li><p>Copy the <code>docker-compose.yml</code> file to the deployment machine. Its content includes GridBeat, eKuiper, and eKuiper&#39;s management interface eKuiper Manager.</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;3.4&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">   manager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">emqx/ekuiper-manager:1.9</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ekuiper-manager</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;9082:9082&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">   ekuiper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lfedge/ekuiper:1.9</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;9081:9081&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ekuiper</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ekuiper</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">         KUIPER__BASIC__CONSOLELOG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;true&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">         KUIPER__BASIC__IGNORECASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;false&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/tmp/data:/kuiper/data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/tmp/log:/kuiper/log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">   gridbeat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">emqx/gridbeat:2.4.0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      ports</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;7000:7000&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         # The default port to communicate with eKuiper. Change it if you want to use another port.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;7081:7081&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      container_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gridbeat</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gridbeat</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      environment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">         DISABLE_AUTH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/tmp/gridbeat/data:/opt/gridbeat/persistence</span></span></code></pre></div><p>Here is the configuration explanation:</p><ul><li><p>In this configuration file, GridBeat and eKuiper use port 7081 for communication. GridBeat listens on port 7081 and waits for eKuiper&#39;s connection.</p></li><li><p>Since the GridBeat container and eKuiper container have configured hostnames, the software can access each other using the hostnames. If hostnames are not configured, you can use the IP address of the host machine for communication.</p></li><li><p>The version of the GridBeat, eKuiper, and eKuiper-manager images can be adjusted according to the actual usage. As long as GridBeat &gt;= 2.4.0 and eKuiper &gt;= 1.9.0, it should work. It is recommended to keep the eKuiper-manager version consistent with the eKuiper version.</p></li><li><p>For eKuiper environment variable configurations, you can refer to <a href="https://ekuiper.org/docs/zh/latest/configuration/configuration.html" target="_blank" rel="noreferrer">specific documentation for eKuiper</a>.</p></li></ul></li><li><p>In the directory of <code>docker-compose.yml</code>, run following:</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># docker compose up -d</span></span></code></pre></div></li><li><p>After all the containers have started, please use the <code>docker ps</code> command to confirm that all the containers have started successfully.</p><p><img src="`+n+'" alt="image-20230416222743879"></p></li></ol><h2 id="configure-gridbeat" tabindex="-1">Configure GridBeat <a class="header-anchor" href="#configure-gridbeat" aria-label="Permalink to “Configure GridBeat”">​</a></h2><h3 id="southbound-device" tabindex="-1">Southbound Device <a class="header-anchor" href="#southbound-device" aria-label="Permalink to “Southbound Device”">​</a></h3><p>Once GridBeat is launched, the initial step involves configuring the southbound devices and employing a simulator for data collection simulation. For comprehensive guidance on setting up the southbound devices and the simulator, please refer to the <a href="./../../../quick-start/quick-start.html">GridBeat Quick Start Guide</a> to successfully complete this crucial configuration phase.</p><h3 id="northbound-application" tabindex="-1">Northbound Application <a class="header-anchor" href="#northbound-application" aria-label="Permalink to “Northbound Application”">​</a></h3><p><strong>Create the Application</strong></p><p>On <strong>Configuration -&gt; North Apps</strong>, click <strong>Add Application</strong> to add an eKuiper client node.</p><ol><li>Enter an application name, for example, &quot;ekuiper-1&quot;.</li><li>In the dropdown menu, you will see the available northbound applications for this software version. In this case, select the plugin for eKuiper.</li></ol><p><img src="'+r+'" alt="image-20230416223245020"></p><p>Upon successful application creation, a new card for the application will appear on the Northbound Application Management interface, showing an <strong>Initializing</strong> work state and a <strong>Disconnected</strong> connection status.</p><p><strong>Configure the Application</strong></p><p>Click the <strong>Application Configuration</strong> icon on the application card to enter the application configuration interface, click <strong>Confirm</strong> to use the default configuration.</p><p><img src="'+o+'" alt="image-20230416223531514"></p><p><strong>Subscribe to a Group</strong></p><p>Click on any blank area of the application card &quot;ekuiper-1&quot; to enter the subscription group interface.</p><p><img src="'+p+'" alt="image-20230416223756941"></p><ol><li>Click the <strong>Add Subscription</strong> button in the top right corner.</li><li>In the dropdown menu, select the southbound device. In this case, we choose the previously created southbound device &quot;Modbus1&quot;.</li><li>Select the desired Group to subscribe to from the dropdown menu. In this case, we choose the group of the previously created southbound device &quot;Modbus1&quot;.</li><li>Click <strong>Submit</strong> to complete the subscription.</li></ol><p>At this point, GridBeat is configured for data collection and sending the collected data to the northbound eKuiper channel.</p><p>Note: Since there is currently no eKuiper connected to the current GridBeat, the connection status of the GridBeat northbound application to the eKuiper node will remain <strong>Disconnected</strong>.</p><p><img src="'+l+'" alt="image-20230416224028630"></p><h2 id="configure-ekuiper" tabindex="-1">Configure eKuiper <a class="header-anchor" href="#configure-ekuiper" aria-label="Permalink to “Configure eKuiper”">​</a></h2><p>eKuiper Manager is a web management interface that allows you to manage multiple eKuiper instances. Therefore, we need to configure the eKuiper instances managed by the manager. For detailed instructions, please refer to the documentation on how to use the <a href="https://ekuiper.org/docs/en/latest/operation/manager-ui/overview.html" target="_blank" rel="noreferrer">eKuiper Management Console</a>.</p><p>In the following tutorial, we will use eKuiper Manager to configure and manage eKuiper, including the creation of flows and rules.</p><h3 id="add-ekuiper-node" tabindex="-1">Add eKuiper Node <a class="header-anchor" href="#add-ekuiper-node" aria-label="Permalink to “Add eKuiper Node”">​</a></h3><p>To log in to eKuiper Manager, access http://[yourhost]:9082 using your web browser. The default username and password are:</p><ul><li>admin</li><li>public</li></ul><p>To add an eKuiper service:</p><p><img src="'+h+'" alt="image-20230416224606764"></p><ol><li><p>Select the <strong>Service Type</strong> as <strong>Direct Link Service</strong>.</p></li><li><p>Choose a custom service name.</p></li><li><p>In the <strong>Endpoint</strong> URL field, enter the hostname of the eKuiper container followed by the port number 9081.</p></li></ol><h3 id="create-gridbeat-data-stream" tabindex="-1">Create GridBeat Data Stream <a class="header-anchor" href="#create-gridbeat-data-stream" aria-label="Permalink to “Create GridBeat Data Stream”">​</a></h3><p>Log in to your eKuiper node and navigate to the <strong>Stream Management</strong> page to create a new stream. Here are the specific configurations:</p><p><img src="'+c+'" alt="image-20230416225210309"></p><ol><li><p>You can customize any stream name. In the example, let&#39;s name it <code>gridbeatStream</code>.</p></li><li><p>Set the stream type as <code>gridbeat</code>, indicating that this stream will connect to GridBeat.</p></li><li><p>Configure the group by selecting &quot;Add Configuration Group.&quot; Name it <code>gridbeat-source</code> and set the path as <code>tcp://gridbeat:7081</code>, where <code>gridbeat</code> matches the hostname of the GridBeat container.</p></li><li><p>Click on &quot;Submit&quot; to save the configuration.</p></li></ol><h3 id="create-ekuiper-rules" tabindex="-1">Create eKuiper Rules <a class="header-anchor" href="#create-ekuiper-rules" aria-label="Permalink to “Create eKuiper Rules”">​</a></h3><p>After establishing the GridBeat flow, we can create multiple rules in eKuiper to perform various calculations and processing on the collected data. This article only show a simple rule that print GridBeat data to eKuiper&#39;s log. For more advanced data processing capabilities of eKuiper, please refer to the additional resources section.</p><p>Here is an example of creating a new eKuiper rule:</p><p><img src="'+d+'" alt="image-20230416225851891"></p><p>Add a rule action and submit the rule.</p><p><img src="'+k+'" alt="image-20230416225937554"></p><h2 id="verify-gridbeat-and-ekuiper-communication-status" tabindex="-1">Verify GridBeat and eKuiper Communication Status <a class="header-anchor" href="#verify-gridbeat-and-ekuiper-communication-status" aria-label="Permalink to “Verify GridBeat and eKuiper Communication Status”">​</a></h2><p>GridBeat connection is normal</p><p><img src="'+u+'" alt="image-20230416230130253"></p><p>eKuiper Rule running status is normal</p><p><img src="'+g+'" alt="image-20230416230150498"></p><p>eKuiper log message is normal.</p><p><img src="'+m+'" alt="image-20230416230234064"></p>',50)])])}const v=e(E,[["render",f]]);export{A as __pageData,v as default};
