import{_ as s,c as i,o as e,ah as t,iu as n,iv as r}from"./chunks/framework.D2dsaVOY.js";const c=JSON.parse('{"title":"eKuiper","description":"","frontmatter":{},"headers":[],"relativePath":"zh_CN/configuration/north-apps/ekuiper/overview.md","filePath":"zh_CN/configuration/north-apps/ekuiper/overview.md"}'),p={name:"zh_CN/configuration/north-apps/ekuiper/overview.md"};function l(h,a,o,d,k,g){return e(),i("div",null,[...a[0]||(a[0]=[t('<h1 id="ekuiper" tabindex="-1">eKuiper <a class="header-anchor" href="#ekuiper" aria-label="Permalink to “eKuiper”">​</a></h1><p>LF Edge <a href="https://ekuiper.org" target="_blank" rel="noreferrer">eKuiper</a> 是 Golang 实现的轻量级物联网数据分析和流处理引擎，可以运行在各类资源受限的边缘设备上。eKuiper 的主要目标是在边缘端提供流式数据处理分析能力，并通过内置的规则引擎帮助用户快速创建物联网边缘分析应用。</p><p>作为一款工业协议网关软件，GridBeat 为使用不同协议的各类设备提供一站式数据采集接入能力，GridBeat北向 eKuiper 插件使用户能够将收集到的数据发布到 eKuiper 进行进一步处理，结合 eKuiper可以将设备数据进行过滤、清洗、实时计算、AI推理和智能告警。二者的结合，提升了工业现场边缘设备的智能化能力，帮助企业实现设备自治、自主决策和敏捷生产。</p><h2 id="特点优势" tabindex="-1">特点优势 <a class="header-anchor" href="#特点优势" aria-label="Permalink to “特点优势”">​</a></h2><p>在边缘端GridBeat结合eKuiper具备如下优势：</p><ul><li><b>数据预处理和转换</b>： 在边缘端进行数据清洗、预处理和转换，eKuiper提供了100+内置函数，以及时间窗口功能，将计算加工过的高价值数据进行转发推送，确保云端AI/ML分析功能的数据质量和一致性。</li><li><b>边缘计算能力</b>：在边缘处理数据，靠近工业设备，减少延迟，实现更快的响应时间。</li><li><b>扩展的数据分析能力</b>：提供先进的实时数据分析功能，支持在边缘端进行AI算法模型推理，例如异常检测、预测性维护和工艺参数优化算法，提升工业边缘智能化。</li><li><b>基于数据驱动的边缘决策</b>：在边缘端分析和处理基于AI的洞察，实时推送告警或对设备进行控制操作，而不仅仅依赖于基于云的决策系统。</li></ul><h2 id="添加插件" tabindex="-1">添加插件 <a class="header-anchor" href="#添加插件" aria-label="Permalink to “添加插件”">​</a></h2><p>在<strong>配置 -&gt; 北向应用</strong>，点击 <strong>添加应用</strong> 添加 eKuiper 客户端节点。</p><h2 id="应用配置" tabindex="-1">应用配置 <a class="header-anchor" href="#应用配置" aria-label="Permalink to “应用配置”">​</a></h2><p>使用 eKuiper 插件时可使用如下参数：</p><table tabindex="0"><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td><strong>本地 IP 地址</strong></td><td>监听 eKuiper 连接的 IP 地址。</td></tr><tr><td><strong>本地端口</strong></td><td>监听 eKuiper 连接的 TCP 端口号。</td></tr></tbody></table><img src="'+n+'" alt="connection_change" style="zoom:50%;"><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>如果您使用docker方式部署GridBeat，需要在docker命令中增加字段<code>-p 7081:7081</code>，将7081端口映射到主机上。docker具体命令可参考 <a href="./../../../installation/docker.html">docker运行</a>。</p></div><h2 id="添加订阅" tabindex="-1">添加订阅 <a class="header-anchor" href="#添加订阅" aria-label="Permalink to “添加订阅”">​</a></h2><p>完成插件的添加和配置后，我们将继续通过订阅南向设备实现数据的转发。</p><p>完成设备配置后，在<strong>北向应用</strong>页，点击设备卡片/设备列进入<strong>组列表</strong>页。点击<strong>添加订阅</strong>，并进行如下设置：</p><ul><li><strong>南向设备</strong>：选择要订阅的南向设备，例如，modbus-tcp-1；</li><li><strong>组</strong>：选择南向设备下的某个组，例如，group-1。</li></ul><p>至此，我们将能通过 GridBeat 将数据转发至 eKuiper 进行下一步处理。</p><p>有关在 eKuiper 中的操作，见<a href="https://ekuiper.org/docs/zh/latest/integrations/gridbeat/gridbeat_integration_tutorial.html#integration-of-gridbeat-and-ekuiper" target="_blank" rel="noreferrer">使用 eKuiper 对 GridBeat 采集的数据进行流式处理</a>。</p><h2 id="应用场景" tabindex="-1">应用场景 <a class="header-anchor" href="#应用场景" aria-label="Permalink to “应用场景”">​</a></h2><p>通过 GridBeat eKuiper 插件，您可在 GridBeat 和 eKuiper 之间建立直接的数据通道，实现诸如将 GridBeat 收集到的数据打印到 eKuiper 的日志等操作，具体步骤，见 <a href="./ekuiper.html">GridBeat 与 eKuiper 集成最佳实践</a>。</p><h2 id="运行与维护" tabindex="-1">运行与维护 <a class="header-anchor" href="#运行与维护" aria-label="Permalink to “运行与维护”">​</a></h2><p>在设备卡片或设备列，您可点击数据统计图表查看及应用运行情况、接受和发送的数据情况。关于统计字段的说明，见<a href="./../north-apps.html">创建北向应用</a>。</p><p>如果设备运行出现任何问题，您可点击 DEBUG 日志图表，此时系统将自动打印该节点的 DEBUG 级别日志，十分钟后将切回系统默认级别日志。稍后，您可点击页面顶部功能栏的<strong>系统信息</strong> -&gt; <strong>日志</strong>查看日志，并进行故障诊断。稍后，您可点击页面顶部功能栏的<strong>系统信息</strong> -&gt; <strong>日志</strong>查看日志，并进行故障诊断。有关系统日志的详细解析，见<a href="./../../../admin/log-management.html">管理日志</a>。</p><h2 id="版本兼容性" tabindex="-1">版本兼容性 <a class="header-anchor" href="#版本兼容性" aria-label="Permalink to “版本兼容性”">​</a></h2><p>GridBeat 和 eKuiper 之间的交互是双向的，需要两边同时提供支持：</p><ul><li>GridBeat 方面，提供 eKuiper 插件以支持向 eKuiper 发布数据并接收命令。</li><li>eKuiper 方面，提供一个 GridBeat 源以支持从 GridBeat 订阅数据，以及一个 GridBeat 动作以支持通过 GridBeat 控制设备。</li></ul><table tabindex="0"><thead><tr><th>GridBeat 版本</th><th>eKuiper 版本</th><th>发布历史</th><th>使用限制</th></tr></thead><tbody><tr><td>GridBeat 2.0</td><td>eKuiper 1.5</td><td>1. GridBeat 首次引入 eKuiper 插件<br>2. eKuiper 首次添加 GridBeat 源和动作 <br>3. GridBeat 和 eKuiper 基于 <a href="https://nng.nanomsg.org/man/v1.3.2/nng_ipc.7.html" target="_blank" rel="noreferrer">IPC 传输层</a>的 <a href="https://nng.nanomsg.org/man/v1.3.2/nng_pair.7.html" target="_blank" rel="noreferrer">NNG pair0 协议</a>进行通信<br></td><td>1. GridBeat 和 eKuiper 应部署在同一个主机（或使用 MQTT 作为双方之间的中继）<br>2. 一对一通信</td></tr><tr><td>GridBeat 2.4 及以上</td><td>GridBeat 1.9 及以上</td><td>1. GridBeat 和 eKuiper 基于 <a href="https://nng.nanomsg.org/man/v1.3.2/nng_tcp.7.html" target="_blank" rel="noreferrer">TCP 传输层</a> 进行通信 <br>2. 支持多对多连接</td><td>-</td></tr></tbody></table><p>传输协议的变化如下图所示：<img src="'+r+`" alt="connection_change" style="zoom:50%;"></p><h2 id="拓展阅读" tabindex="-1">拓展阅读 <a class="header-anchor" href="#拓展阅读" aria-label="Permalink to “拓展阅读”">​</a></h2><p>本节描述了 GridBeat 和 eKuiper 之间的底层通信细节，可选择跳过。</p><h3 id="数据上报" tabindex="-1">数据上报 <a class="header-anchor" href="#数据上报" aria-label="Permalink to “数据上报”">​</a></h3><p>GridBeat eKuiper 插件连接到 eKuiper 后，将从设备收集的数据以 JSON 形式发布。 发布到 eKuiper 的数据具有以下字段：</p><ul><li><code>timestamp</code>：数据采集时的 UNIX 时间戳。</li><li><code>node_name</code>：被采集的南向节点的名字。</li><li><code>group_name</code>：被采集的南向节点的点位组的名字。</li><li><code>values</code>：存储采集成功的点位值的字典。</li><li><code>errors</code>：存储采集失败的错误码的字典。</li></ul><p>以下是一个示例数据。当标签读取成功时，它的值将记录在 <em>values</em> 字典中。 如果在读取标签时出错，则将错误代码记录在 <em>errors</em> 字典中。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1646125996000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;node_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;modbus&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;group_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;grp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;values&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;tag0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;tag1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;string&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;errors&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;tag2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1011</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="反向控制" tabindex="-1">反向控制 <a class="header-anchor" href="#反向控制" aria-label="Permalink to “反向控制”">​</a></h3><p>eKuiper 可以通过使用 GridBeat 动作发送写命令来控制设备，GridBeat 在接收到命令后将向设备写入数据。</p><p>写命令应该是一个带有以下字段的 JSON 数据：</p><ul><li><code>node_name</code>：某个南向节点名字。</li><li><code>group_name</code>：南向节点的某个组的名字。</li><li><code>tag_name</code>：要写入的点位名字。</li><li><code>value</code>：要写入的数据值。</li></ul><p>以下是一个写命令示例：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;node_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;modbus&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;group_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;grp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;tag_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;tag0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1234</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>eKuiper 插件也支持如下格式的写请求，用以一次写入多个点位。</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>{</span></span>
<span class="line"><span>    &quot;node_name&quot;: &quot;modbus&quot;,</span></span>
<span class="line"><span>    &quot;group_name&quot;: &quot;grp&quot;,</span></span>
<span class="line"><span>    &quot;tags&quot;: [</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            &quot;tag_name&quot;: &quot;tag0&quot;,</span></span>
<span class="line"><span>            &quot;value&quot;: 1234</span></span>
<span class="line"><span>        },</span></span>
<span class="line"><span>        {</span></span>
<span class="line"><span>            &quot;tag_name&quot;: &quot;tag1&quot;,</span></span>
<span class="line"><span>            &quot;value&quot;: 4567</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    ]</span></span>
<span class="line"><span>}</span></span></code></pre></div>`,44)])])}const E=s(p,[["render",l]]);export{c as __pageData,E as default};
